<!--pages/rewards/rewards.wxml-->
<view class="page" style="background: {{currentTheme.background || 'linear-gradient(135deg, #FFE4E6 0%, #FFF0F5 50%, #E8F5E8 100%)'}}">
  <!-- ç§¯åˆ†æ˜¾ç¤º -->
  <view class="points-display" style="background: linear-gradient(135deg, {{currentTheme.primary || '#FF69B4'}} 0%, {{currentTheme.primaryDark || '#FF1493'}} 50%, {{currentTheme.primaryLight || '#FFB6C1'}} 100%)">
    <view class="points-icon">{{currentTheme.emoji || 'ğŸŒŸ'}}</view>
    <view class="points-number">{{totalPoints}}</view>
    <view class="points-label">âœ¨ æˆ‘çš„å°æ˜Ÿæ˜Ÿ âœ¨</view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn-primary" style="background: linear-gradient(135deg, {{currentTheme.primary || '#FF69B4'}} 0%, {{currentTheme.primaryDark || '#FF1493'}} 100%)" bindtap="addReward">æ·»åŠ æ–°å¥–åŠ±</button>
    <button class="btn-secondary ml-20" style="background: {{currentTheme.secondary || '#FFF0F5'}}; color: {{currentTheme.primary || '#FF69B4'}}; border-color: {{currentTheme.primaryLight || '#FFB6C1'}}" bindtap="toggleTemplates">
      {{showTemplates ? 'éšè—æ¨¡æ¿' : 'ä½¿ç”¨æ¨¡æ¿'}}
    </button>
  </view>

  <!-- æ¨¡æ¿åˆ—è¡¨ -->
  <view wx:if="{{showTemplates}}" class="card">
    <view class="section-title mb-20">å¥–åŠ±æ¨¡æ¿</view>
    <view class="template-grid">
      <view class="template-item" wx:for="{{templates}}" wx:key="name" bindtap="useTemplate" data-template="{{item}}">
        <view class="template-name">{{item.name}}</view>
        <view class="template-points text-warning">{{item.points}}ç§¯åˆ†</view>
      </view>
    </view>
  </view>

  <!-- å¥–åŠ±åˆ—è¡¨ -->
  <view class="card">
    <view class="section-title mb-20">æˆ‘çš„å¥–åŠ± ({{rewards.length}})</view>
    
    <view wx:if="{{rewards.length > 0}}">
      <view class="reward-card" wx:for="{{rewards}}" wx:key="id">
        <view class="reward-header">
          <view class="reward-name">{{item.name}}</view>
          <view class="reward-points text-warning">{{item.points}}ç§¯åˆ†</view>
        </view>
        
        <view class="reward-status">
          <view class="status-text {{totalPoints >= item.points ? 'can-redeem' : 'cannot-redeem'}}">
            {{totalPoints >= item.points ? 'å¯ä»¥å…‘æ¢' : 'ç§¯åˆ†ä¸è¶³'}}
          </view>
        </view>
        
        <view class="reward-actions">
          <button
            class="btn-action btn-redeem"
            style="background: linear-gradient(135deg, {{currentTheme.primary || '#FF69B4'}} 0%, {{currentTheme.primaryDark || '#FF1493'}} 100%)"
            bindtap="redeemReward"
            data-reward="{{item}}"
            disabled="{{totalPoints < item.points}}"
          >
            å…‘æ¢
          </button>
          <button class="btn-action btn-edit" style="background: {{currentTheme.secondary || '#FFF0F5'}}; color: {{currentTheme.primary || '#FF69B4'}}; border-color: {{currentTheme.primaryLight || '#FFB6C1'}}" bindtap="editReward" data-reward="{{item}}">
            ç¼–è¾‘
          </button>
          <button class="btn-action btn-delete" bindtap="deleteReward" data-reward="{{item}}">
            åˆ é™¤
          </button>
        </view>
      </view>
    </view>
    
    <view wx:else class="empty-state">
      <view class="empty-icon">ğŸ</view>
      <view class="empty-text">è¿˜æ²¡æœ‰æ·»åŠ ä»»ä½•å¥–åŠ±</view>
      <button class="btn-primary" style="background: linear-gradient(135deg, {{currentTheme.primary || '#FF69B4'}} 0%, {{currentTheme.primaryDark || '#FF1493'}} 100%)" bindtap="addReward">æ·»åŠ ç¬¬ä¸€ä¸ªå¥–åŠ±</button>
    </view>
  </view>
</view>
